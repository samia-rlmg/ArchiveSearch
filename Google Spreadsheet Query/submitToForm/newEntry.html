<title>Create a New Entry</title>

<body>

  <!-- <form name="newEntry">

    <input name="email" type="email" placeholder="Email" required>
    <button type="submit">Send</button>
   </form>
   <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbwiKQZo4YNnDSHQjmTMuJ_yi6Hqx226JBJozO3OSJBmwbmSMYU/exec'
    const form = document.forms['newEntry']
    form.addEventListener('submit', e => {
     e.preventDefault()
     fetch(scriptURL, { method: 'POST', body: new FormData(form)})
      .then(response => console.log('Success!', response))
      .catch(error => console.error('Error!', error.message))
    })
   </script> -->

  <div class="container">
  <div class="row">
    <div class="col-lg-12">
      <h2>Create a New Entry</h2>
    </div>
  </div>
  <hr>
  <form class="form-horizontal" role="form" id="new-entry-form" name="newEntry">
    <div class="form-group">
      <label class="col-lg-3 control-label">Project Name</label>
      <div class="col-lg-3 inputGroupContainer">
        <div class="input-group">
          <input type="text" class="form-control" name="Project Name" placeholder="Project name"/>
        </div>
      </div>
    </div>

    <div class="form-group">
      <label class="col-lg-3 control-label">Drive Number</label>
      <div class="col-lg-3 inputGroupContainer">
        <div class="input-group">
          <input type="text" class="form-control" name="Drive Number" placeholder="Drive number"/>
        </div>
      </div>
    </div>

    <div class="form-group">
      <label class="col-lg-3 control-label">Project Start Date</label>
      <div class="col-lg-3 inputGroupContainer">
        <div class="input-group">
          <input type="text" class="form-control" name="Project Start Date" placeholder="Project start date"/>
        </div>
      </div>
    </div>

    <div class="form-group">
      <label class="col-lg-3 control-label">Project End Date</label>
      <div class="col-lg-3 inputGroupContainer">
        <div class="input-group col-lg-10">
          <input type="text" class="form-control" name="Project End Date" placeholder="Project end date"></input>
        </div>
      </div>
    </div>

    <div class="form-group">
      <label class="col-lg-3 control-label">Vimeo Album Link</label>
      <div class="col-lg-3 inputGroupContainer">
        <div class="input-group col-lg-10">
          <input type="text" class="form-control" name="Vimeo Album Link" placeholder="Vimeo album link"></input>
        </div>
      </div>
    </div>

    <div class="form-group">
      <label class="col-lg-3 control-label">Drive Contents</label>
      <div class="col-lg-3 inputGroupContainer">
        <div class="input-group col-lg-10">
          <input type="text" class="form-control" name="Drive Contents" placeholder="Drive contents"></input>
        </div>
      </div>
    </div>

    <div class="form-group">
      <label class="col-lg-3 control-label">Project Specs</label>
      <div class="col-lg-3 inputGroupContainer">
        <div class="input-group col-lg-10">
          <input type="text" class="form-control" name="Project Specs" placeholder="Project specs"></input>
        </div>
      </div>
    </div>

    <div class="form-group">
      <label class="col-lg-3 control-label">Project Managers/Producers</label>
      <div class="col-lg-3 inputGroupContainer">
        <div class="input-group col-lg-10">
          <input type="text" class="form-control" name="Project Managers/Producers" placeholder="Project managers/producers"></input>
        </div>
      </div>
    </div>

    <div class="form-group">
      <label class="col-lg-3 control-label">Featured Exhibits</label>
      <div class="col-lg-3 inputGroupContainer">
        <div class="input-group col-lg-10">
          <input type="text" class="form-control" name="Featured Exhibits" placeholder="Featured exhibits"></input>
        </div>
      </div>
    </div>

    <div class="form-group">
      <label class="col-lg-3 control-label">LTO Number</label>
      <div class="col-lg-3 inputGroupContainer">
        <div class="input-group col-lg-10">
          <textarea type="text" class="form-control" name="LTO Number" placeholder="LTO number"></textarea>
        </div>
      </div>
    </div>

    <div class="form-group">
      <label class="col-lg-3 control-label">Location of Files</label>
      <div class="col-lg-3 inputGroupContainer">
        <div class="input-group col-lg-10">
          <input type="text" class="form-control" name="Location of Files" placeholder="Location of Files"></input>
        </div>
      </div>
    </div>

    <div class="form-group">
      <label class="col-lg-3 control-label">Keywords</label>
      <div class="col-lg-3 inputGroupContainer">
        <div class="input-group col-lg-10">
          <input type="text" class="form-control" name="Keywords" placeholder="Keywords"></input>
        </div>
      </div>
    </div>

    <div class="form-group">
      <div class="col-lg-9 col-lg-offset-3">
        <button type="submit" class="btn btn-default" id="postForm">Submit</button>
      </div>
    </div>

  </form>

  </div>
</body>

<script>

const scriptURL = 'https://script.google.com/macros/s/AKfycbzYVQZZOE6LUGIM2EkyBJfl7FFZ7Qc0fmqC0EZQpQaH1Qdck5h_/exec';
const form = document.forms['newEntry']

//Put the user-entered link inside HTML tags
form.addEventListener('submit', e => {
  var txt = document.getElementById('preview');
  //Check if it begins with "http://"; append it if not
  if ((txt.value.indexOf("http") == -1) && (txt.value)) {
    txt.value = "http://" + txt.value;
  }
  //Replace link with HTML tags
  if (txt.value) {
    txt.value = `<a onclick="window.open('` + txt.value.trim() + `', 'popup', 'width=700,height=500'); return false;">Preview</a>`;
  }
})

 //Post submitted data to Google sheet
 form.addEventListener('submit', e => {
  e.preventDefault()
  fetch(scriptURL, { method: 'POST', body: new FormData(form)})
   .then(response => console.log('Success!', response))
   .catch(error => console.error('Error!', error.message))
   redirect();
 })

 //Redirect to "success" page
 function redirect() {
  const redirectUrl = 'success-page.html';
  // $("form").on("submit", function() {
    setTimeout("location.href = 'success-page.html';",100);
  //   $(location).attr('href',redirectUrl);
  // })
}

</script>

<footer>
<!-- <script src="validation-functions.js"></script> -->
</footer>

</html>
